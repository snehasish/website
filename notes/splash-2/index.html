<!DOCTYPE html>
<html lang="en">
<head>
        <title>Snehasish</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Removed FEED blocks, will add back ONE later -->
        <link href="../../theme/css/bootstrap.css" rel="stylesheet" media="screen">
        <link href="../../theme/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
        <link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light+Two' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../theme/css/base.css" />
        <link rel="stylesheet" href="../../theme/css/syntax.css" />
        <script src="../../theme/js/jquery-2.0.2.min.js"></script>
        <script src="../../theme/js/bootstrap.min.js"></script>
</head>

<body id="index" class="home">

        <div class="container">

            <div class="row">            
                <div class="span12">
                    <h1 id="site-header"><a href="../..">Snehasish</a>
                        <small style="font-size:40%">(pronounced snā-hä-SHēSH)</small></h1>
                </div>
            </div>
            <hr style="margin:0px 0px 10px 0px;"/>
            <div class="row">
                <div class="span12">
                    <ul class="nav nav-pills pull-right">
                    
                    <li  ><a href="../../index.html">Home</a></li>

                            <li class="active"><a href="../../category/notes.html">Notes</a></li>

                            <li><a href="../../pages/contact.html">Contact</a></li>
                            <li><a href="../../pages/news.html">News</a></li>
                            <li><a href="../../pages/resume.html">Resume</a></li>

                    
                    
                    </ul>
                </div>    
            </div>    
<div class="row">
  <div class="span12">
  <section id="content" class="body">
    
      <h3 class="entry-title">
        <a href="../../notes/splash-2/" rel="bookmark"
           title="Permalink to SPLASH2">SPLASH2</a></h3>

      <div class="row">
        <div class="span8 pull-left">
            <span class="label">programming</span>
            <span class="label">benchmarks</span>
            <span class="label">parallel</span>
        </div>

        <div class="span4 pull-right text-right">
        <abbr class="published" title="2012-11-03T00:00:00">
          Sat 03 November 2012
        </abbr>
        </div>
      </div>

    <div class="entry-content">
      <p>Recently I was had to compile and run the SPLASH2 benchmark suite. I obtained the package from Ken Barr's website <a href="http://kbarr.net/splash2">here</a> and used the PARMACS implementation written by Bastiaan Stougie based on pthreads. I've since made some modifications to it to include macros to mark the begin and end of the region of interest (thread fork to join) for these applications. Here are some notes on fixing the problems I faced while doing so. The server configuration is an AMD Opteron running Ubuntu 10.04 (x86_64).</p>
<p>For all applications I removed the <code>-Olimit 2000</code> and <code>-lmpc</code> switches and added <code>-lpthread</code> in the included makefiles.</p>
<h3>barnes</h3>
<ol>
<li>Remove <code>#include "ulocks.h"</code> from <code>defs.H</code></li>
<li>Add <code>#include &lt;stdlib.h&gt;</code> to <code>util.H</code></li>
<li>Add <code>#include &lt;errno.h&gt;</code> to <code>util.H</code>, the need for this may manifest in 2 ways. Firstly, as noted in <a href="http://thechatterjee.blogspot.ca/2009/07/barnes-hut-splash2-installation-fix.html">this blog</a> and secondly (as I observed), <code>ld</code> segfaults ( collect2: ld terminated with signal 11 [Segmentation fault]).</li>
</ol>
<h3>lu</h3>
<ol>
<li>There is a semicolon missing at the end of line 203 in lu.C for both contiguous and non-contiguous versions of the program.</li>
</ol>
<h3>volrend</h3>
<ol>
<li>Install libtiff4-dev if not installed, required for tiffio.h (easier than using the libtiff.Z package provided)</li>
<li>Comment out <code>char *calloc();</code> line 395 from main.C</li>
<li>Set or unset -DFLIP depending on endianess. On Opteron it needs to be unset.</li>
<li>Gunzip the input files (*.den.Z)</li>
<li>When passing the input name to the program, omit .den extension</li>
<li>And then it crashes after trying to allocate a density map of size ~6GB. Add -m32 to CFLAGS.</li>
<li>Set <code>PREPROCESS 1</code> and <code>RENDER_ONLY 0</code> in user_options.h</li>
<li>Clean *.o and executable and recompile</li>
<li>Running the executable now should give us .norm, .opc, .pyr files in the same dir as the .den file</li>
<li>Set <code>PREPROCESS 0</code> and <code>RENDER_ONLY 1</code> in user_options.h</li>
<li>Clean *.o and executable and recompile</li>
<li>Execute with n threads (for command line arg n, it forks off n-1 threads), you should get 4 tiff files, head_000X.tiff.</li>
</ol>
<h4>water-spatial</h4>
<ol>
<li>Remove extra <code>../</code> in makefile for path to m4 macro file.</li>
<li>Comment out redeclaration of <code>srandom()</code>, initia.C:52</li>
</ol>
    </div><!-- /.entry-content -->

    

  </section>
  </div>
</div>



            <hr style="margin:30px 0px 0px 0px;"/>
            <div class="row">
                <div class="span12">
                    <footer class="text-center"> Generated by <a href="http://blog.getpelican.com/">pelican</a>. Uses Google <a href="http://www.google.com/fonts/">webfonts</a> and Twitter <a href="http://twitter.github.io/bootstrap/">bootstrap</a>.
                    <br />Copyright &copy; Snehasish Kumar, 2013
                    </footer>
                </div> 
            </div>

        </div>
</body>
</html>